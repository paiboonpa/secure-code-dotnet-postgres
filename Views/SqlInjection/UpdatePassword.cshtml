@{
    ViewData["Title"] = "SQL Injection - Update Password";
}

<h2>SQL Injection Update Password Demo</h2>

<div style="background-color: #ffebee; border: 1px solid #f44336; padding: 15px; margin: 20px 0; border-radius: 5px;">
    <h3 style="color: #d32f2f; margin-top: 0;">‚ö†Ô∏è WARNING: VULNERABLE CODE</h3>
    <p>This page demonstrates SQL Injection vulnerabilities for educational purposes only.</p>
    <p><strong>DO NOT</strong> use this code in production applications!</p>
</div>

<!-- Vulnerable Form -->
<div style="margin-bottom: 30px;">
    <h3>üö® Vulnerable Update (SQL Injection Possible)</h3>
    <form method="post" action="/SqlInjection/update-password" style="border: 2px solid #f44336; padding: 20px; border-radius: 5px; background-color: #ffebee;">
        <div style="margin-bottom: 15px;">
            <label for="id" style="display: block; margin-bottom: 5px; font-weight: bold;">User ID:</label>
            <input type="text" id="id" name="id" value="1" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 3px;" />
        </div>
        <div style="margin-bottom: 15px;">
            <label for="password" style="display: block; margin-bottom: 5px; font-weight: bold;">New Password:</label>
            <input type="text" id="password" name="password" value="newpass123" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 3px;" />
        </div>
        <button type="submit" style="background-color: #f44336; color: white; padding: 10px 20px; border: none; border-radius: 3px; cursor: pointer;">Update Password (Vulnerable)</button>
    </form>
</div>

<!-- Protected Form -->
<div style="margin-bottom: 30px;">
    <h3>‚úÖ Protected Update (Parameterized Query)</h3>
    <form method="post" action="/SqlInjection/update-password-protected" style="border: 2px solid #4caf50; padding: 20px; border-radius: 5px; background-color: #e8f5e8;">
        <div style="margin-bottom: 15px;">
            <label for="protected_id" style="display: block; margin-bottom: 5px; font-weight: bold;">User ID:</label>
            <input type="text" id="protected_id" name="id" value="1" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 3px;" />
        </div>
        <div style="margin-bottom: 15px;">
            <label for="protected_password" style="display: block; margin-bottom: 5px; font-weight: bold;">New Password:</label>
            <input type="text" id="protected_password" name="password" value="newpass123" required style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 3px;" />
        </div>
        <button type="submit" style="background-color: #4caf50; color: white; padding: 10px 20px; border: none; border-radius: 3px; cursor: pointer;">Update Password (Protected)</button>
    </form>
</div>

<!-- Results Section -->
@if (ViewData["Message"] != null)
{
    <div style="background-color: #e8f5e8; border: 1px solid #4caf50; padding: 15px; margin: 20px 0; border-radius: 5px;">
        <h3 style="color: #2e7d32; margin-top: 0;">‚úÖ Success</h3>
        <p><strong>@ViewData["Message"]</strong></p>
        <p><strong>Method:</strong> @ViewData["Method"]</p>
        <p><strong>Rows Affected:</strong> @ViewData["RowsAffected"]</p>
        <p><strong>User ID:</strong> @ViewData["Id"]</p>
        <p><strong>New Password:</strong> @ViewData["Password"]</p>
    </div>
}

@if (ViewData["Error"] != null)
{
    <div style="background-color: #ffebee; border: 1px solid #f44336; padding: 15px; margin: 20px 0; border-radius: 5px;">
        <h3 style="color: #d32f2f; margin-top: 0;">‚ùå Error</h3>
        <p><strong>@ViewData["Error"]</strong></p>
        <p><strong>Method:</strong> @ViewData["Method"]</p>
        <p><strong>User ID:</strong> @ViewData["Id"]</p>
        <p><strong>New Password:</strong> @ViewData["Password"]</p>
    </div>
}

@if (ViewData["Sql"] != null)
{
    <div style="background-color: #fff3e0; border: 1px solid #ff9800; padding: 15px; margin: 20px 0; border-radius: 5px;">
        <h3 style="color: #e65100; margin-top: 0;">üîç SQL Query Executed</h3>
        <code style="background-color: #f5f5f5; padding: 10px; display: block; white-space: pre-wrap; border-radius: 3px;">@ViewData["Sql"]</code>
    </div>
}

<!-- SQL Injection Examples -->
<div style="margin-top: 30px;">
    <h3>üéØ SQL Injection Examples to Try:</h3>
    <div style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; border-left: 4px solid #2196f3;">
        <p><strong>For the vulnerable form, try these in the "New Password" field:</strong></p>
        <ul>
            <li><code>test' OR '1'='1</code> - Will update ALL users' passwords!</li>
            <li><code>test'; UPDATE USERS SET MONEY = 999999 WHERE ID = 1; --</code> - Will update password AND money!</li>
            <li><code>test'; DELETE FROM USERS WHERE ID > 1; --</code> - Will delete all users except ID 1!</li>
            <li><code>test'; DROP TABLE USERS; --</code> - Will delete the entire table!</li>
        </ul>
        <p style="color: #d32f2f; font-weight: bold;">‚ö†Ô∏è These will actually modify the database. Use with caution!</p>
    </div>
</div>

<!-- Test Links -->
<div style="margin-top: 30px;">
    <h3>üîó Quick Actions:</h3>
    <div style="background-color: #e3f2fd; padding: 15px; border-radius: 5px;">
        <a href="/SqlInjection/injection?id=1" style="margin-right: 15px; text-decoration: none; color: #1976d2;">‚Üê Back to SQL Injection Demo</a>
        <a href="/" style="text-decoration: none; color: #1976d2;">‚Üê Home</a>
    </div>
</div>